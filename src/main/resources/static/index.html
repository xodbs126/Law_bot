<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë²•ë¥  ìƒë‹´ ì‹œìŠ¤í…œ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            text-align: center;
        }
        h2 {
            color: #333;
        }
        .container {
            width: 50%;
            margin: auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .input-group {
            margin: 15px 0;
        }
        input, textarea, button {
            width: 90%;
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        button {
            background-color: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
        }
        .needed {
            background-color: #28a745;
            color: white;
        }
        .not-needed {
            background-color: #dc3545;
            color: white;
        }
    </style>
</head>
<body>

<h2>ë²•ë¥  ìƒë‹´ ì‹œìŠ¤í…œ</h2>

<div class="container">
    <h3>ğŸ“ ì‚¬ìš©ì ë“±ë¡</h3>
    <div class="input-group">
        <input type="text" id="username" placeholder="ì‚¬ìš©ì ì´ë¦„">
        <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
        <input type="email" id="email" placeholder="ì´ë©”ì¼">
        <select id="role">
            <option value="USER">ì¼ë°˜ ì‚¬ìš©ì</option>
            <option value="LAWYER">ë³€í˜¸ì‚¬</option>
        </select>
        <button onclick="registerUser()">íšŒì›ê°€ì…</button>
    </div>
    <p id="registerResult"></p>
</div>

<div class="container">
    <h3>âš–ï¸ ë²•ë¥  ìƒë‹´ ìš”ì²­</h3>
    <div class="input-group">
        <input type="number" id="userId" placeholder="ì‚¬ìš©ì ID ì…ë ¥">
        <textarea id="description" placeholder="ì‚¬ê±´ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
        <button onclick="submitInquiry()">ìƒë‹´ ìš”ì²­</button>
    </div>
    <p id="inquiryResult"></p>
</div>

<div class="container">
    <h3>ğŸ“œ ìƒë‹´ ìš”ì²­ ëª©ë¡ ì¡°íšŒ</h3>
    <button onclick="fetchInquiries()">ëª¨ë“  ìƒë‹´ ìš”ì²­ ë³´ê¸°</button>
    <div id="inquiriesList"></div>
</div>

<div class="container">
    <h3>ğŸ” ìƒë‹´ ìƒì„¸ ì¡°íšŒ</h3>
    <div class="input-group">
        <input type="number" id="inquiryId" placeholder="ìƒë‹´ ID ì…ë ¥">
        <button onclick="fetchInquiryDetails()">ìƒë‹´ ìƒì„¸ í™•ì¸</button>
    </div>
    <div id="inquiryDetails"></div>
</div>

<script>
    const API_BASE = "http://localhost:8080/api";

    // ì‚¬ìš©ì ë“±ë¡ ìš”ì²­
    function registerUser() {
        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;
        const email = document.getElementById("email").value;
        const role = document.getElementById("role").value;

        fetch(`${API_BASE}/users/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, password, email, role })
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("registerResult").innerText = "âœ… ì‚¬ìš©ì ë“±ë¡ ì„±ê³µ! ID: " + data.id;
        })
        .catch(error => {
            document.getElementById("registerResult").innerText = "âŒ ì‚¬ìš©ì ë“±ë¡ ì‹¤íŒ¨!";
        });
    }

    // ìƒë‹´ ìš”ì²­ ì œì¶œ
    function submitInquiry() {
        const userId = document.getElementById("userId").value;
        const description = document.getElementById("description").value;

        fetch(`${API_BASE}/inquiries/${userId}`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(description)
        })
        .then(response => response.json())
        .then(data => {
            document.getElementById("inquiryResult").innerHTML = `âœ… ìƒë‹´ ìš”ì²­ ì™„ë£Œ! ìƒë‹´ ID: ${data.id}`;
        })
        .catch(error => {
            document.getElementById("inquiryResult").innerText = "âŒ ìƒë‹´ ìš”ì²­ ì‹¤íŒ¨!";
        });
    }

    // ëª¨ë“  ìƒë‹´ ìš”ì²­ ì¡°íšŒ
    function fetchInquiries() {
        fetch(`${API_BASE}/inquiries`)
        .then(response => response.json())
        .then(data => {
            let html = "<ul>";
            data.forEach(inquiry => {
                html += `<li>ğŸ†” ${inquiry.id} - ${inquiry.description} (ğŸ“Œ ${inquiry.status})</li>`;
            });
            html += "</ul>";
            document.getElementById("inquiriesList").innerHTML = html;
        })
        .catch(error => {
            document.getElementById("inquiriesList").innerText = "âŒ ìƒë‹´ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨!";
        });
    }

    // íŠ¹ì • ìƒë‹´ ìš”ì²­ ìƒì„¸ ì¡°íšŒ
    function fetchInquiryDetails() {
        const inquiryId = document.getElementById("inquiryId").value;

        fetch(`${API_BASE}/inquiries/${inquiryId}`)
        .then(response => response.json())
        .then(data => {
            let resultClass = data.status === "NEEDED" ? "needed" : "not-needed";
            document.getElementById("inquiryDetails").innerHTML = `
                <div class="result ${resultClass}">
                    ğŸ†” ìƒë‹´ ID: ${data.id}<br>
                    ğŸ“œ ì‚¬ê±´ ì„¤ëª…: ${data.description}<br>
                    ğŸ“Œ ìƒë‹´ í•„ìš” ì—¬ë¶€: <strong>${data.status}</strong>
                </div>
            `;
        })
        .catch(error => {
            document.getElementById("inquiryDetails").innerText = "âŒ ìƒë‹´ ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨!";
        });
    }
</script>

</body>
</html>
